<main>
    <app-modal *ngIf="isShown" [isShown]="isShown" [name]="name" (closeModal)="onCloseModal($event)"
        (confirmDelete)="onDeleteConfirmed()"></app-modal>
    <section id="hero">
        <app-loader *ngIf="isLoading" />
        <div *ngIf="!isLoading" class="rescent">
            <div class="container" [ngStyle]="{ 'background-image': 'url(' + 'data:image/png;base64,' + image + ')'}">
                <div class="container__info">
                    <div class="actions">
                        <span *ngIf="!isOwner" (click)="like()"><i class="fas fa-heart"></i>2350</span>
                        <span *ngIf="isOwner"><i class="fas fa-heart"></i>2350</span>
                        <span (click)="showCommentSection()"><i class="fas fa-comment-alt"></i>624</span>
                        <span><i class="fas fa-download"></i>1470</span>
                    </div>
                    <div *ngIf="isOwner" class="owner">
                        <a routerLink="/logs/{{log?._id}}/edit"><i class="fas fa-pen-to-square"></i></a>
                        <a href="javascript:void(0)" (click)="showDeleteModal()"><i class="fas fa-trash"></i></a>
                    </div>
                </div>
                <div class="container__profile">
                    <img [ngStyle]="{ 'background-image': 'url(' + 'data:image/png;base64,' + avatar + ')'}" />
                    <div class="container__profile__text">
                        <h2>{{log?.name}}</h2>
                        <p>by <b>{{log?._ownerId?.username}}</b></p>
                        <p>{{log?.date}}</p>
                        <p>{{log?.location}}</p>
                        <p>{{log?.description}}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- <div class="addComments">
            <form>
                <textarea id="comment-textarea" name="comment" cols="40" rows="10"
                placeholder="Add comment..."></textarea>
                <button type="submit">Post</button>
            </form>
        </div> -->


    </section>

    <div *ngIf="showComments" class="comment-session">
        <div  *ngIf="log?.commentList" class="post-comment">

            <div *ngFor="let comment of log?.commentList" class="list">
                <div class="user">
                    <div class="user-image"><img src="../../../assets/images/default_user.png" alt="image"></div>
                    <div class="user-meta">
                        <div class="name">DON BASTON</div>
                        <div class="day">1 month ago</div>
                    </div>
                </div>
                <div class="comment-post">{{comment.comment}}</div>
            </div>

        </div>
        <div *ngIf="!isOwner" class="comment-box">
            <div class="user">
                <div class="image"><img src="../../../assets/images/default_user.png" alt="image"></div>
                <div class="name">Urgazmus</div>
            </div>
            <form #commentForm="ngForm" (ngSubmit)="addComment(commentForm)">
                <textarea name="comment" placeholder="Your Message" ngModel #inputComment="ngModel" required
                    minlength="3"></textarea>

                    <ng-container *ngIf="inputComment.touched">
                        <p class="error" *ngIf="inputComment.errors?.['required']">
                            Comment is required!
                        </p>
                        <p class="error" *ngIf="inputComment.errors?.['minlength']">
                            Comment must be at least {{inputComment.errors?.['minlength']['requiredLength']}} characters!
                        </p>
                    </ng-container>

                <button [disabled]="commentForm.invalid" class="comment-submit">Comment</button>
            </form>
        </div>
    </div>

</main>